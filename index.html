<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Para ti</title>
  <style>
    :root { --bg: #fff7f9; --fg: #222; --accent: #e91e63; --card: #ffffff; }
    * { box-sizing: border-box; }
    body { margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji"; background: var(--bg); color: var(--fg); overflow-x: hidden; }
    .wrap { max-width: 720px; margin: 0 auto; padding: 24px; position: relative; z-index: 2; }
    .card { background: var(--card); border-radius: 16px; padding: 24px; box-shadow: 0 6px 24px rgba(0,0,0,.06); position: relative; z-index: 2; text-align: center; }

    /* T√≠tulo con brillo y corazones latiendo */
    h1 { margin: 0 0 8px 0; font-size: 36px; color: var(--accent); display: flex; align-items: center; justify-content: center; gap: 12px; cursor: pointer; position: relative; text-shadow: 0 0 10px rgba(233,30,99,0.6), 0 0 20px rgba(233,30,99,0.3); animation: glow 2s ease-in-out infinite alternate; }
    @keyframes glow { 0% { text-shadow: 0 0 8px rgba(233,30,99,0.6), 0 0 16px rgba(233,30,99,0.3); } 100% { text-shadow: 0 0 16px rgba(233,30,99,1), 0 0 32px rgba(233,30,99,0.6); } }

    .heart-anim { width: 36px; height: 36px; fill: var(--accent); animation: beatHeart 1s ease-in-out infinite; filter: drop-shadow(0 0 6px rgba(233,30,99,0.6)); }
    @keyframes beatHeart { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.3); } }

    /* Subt√≠tulos con latido lento */
    h2 { margin: 24px 0 8px 0; font-size: 20px; color: var(--accent); animation: beatText 3s ease-in-out infinite; }
    @keyframes beatText { 0%, 100% { transform: scale(1); text-shadow: 0 0 5px rgba(233,30,99,0.3); } 50% { transform: scale(1.1); text-shadow: 0 0 15px rgba(233,30,99,0.6); } }

    p { line-height: 1.6; margin: 8px 0; }
    ul { padding-left: 18px; margin: 8px 0; text-align: left; }
    li { margin: 6px 0; }
    .heart { font-size: 18px; color: var(--accent); }
    .footer { margin-top: 20px; font-size: 14px; opacity: .8; }
    .note { font-size: 13px; opacity: .9; margin-top: 6px; }
    img.hero { width: 100%; border-radius: 12px; display: block; margin: 12px 0; }

    .hidden-message { display: none; margin-top: 20px; font-size: 22px; color: var(--accent); font-weight: bold; animation: fadeIn 1s ease-in forwards; }
    @keyframes fadeIn { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }

    /* Fondo con coraz√≥n y rosas por encima del texto */
    .scene { position: fixed; inset: 0; overflow: hidden; z-index: 3; pointer-events: none; }
    .bg-heart { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: min(70vmin, 520px); height: auto; opacity: .18; animation: beat 1.25s ease-in-out infinite; z-index: 1; }
    @keyframes beat { 0%, 100% { transform: translate(-50%, -50%) scale(1); } 25% { transform: translate(-50%, -50%) scale(1.06); } 50% { transform: translate(-50%, -50%) scale(1); } 75% { transform: translate(-50%, -50%) scale(1.06); } }

    .rose { position: absolute; top: -10vh; font-size: clamp(28px, 4vmin, 40px); filter: grayscale(1) brightness(0); opacity: 0.5; animation-name: fall, sway; animation-timing-function: linear, ease-in-out; animation-iteration-count: infinite, infinite; }
    @keyframes fall { 0% { transform: translateY(-10vh) rotate(0deg); } 100% { transform: translateY(110vh) rotate(360deg); } }
    @keyframes sway { 0%, 100% { margin-left: 0; } 50% { margin-left: 25px; } }

    /* Bot√≥n recuerdos */
    .memories-btn { background: var(--accent); color: white; border: none; padding: 12px 20px; border-radius: 10px; font-size: 16px; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 0 10px rgba(233,30,99,0.6); }
    .memories-btn:hover { box-shadow: 0 0 20px rgba(233,30,99,0.8); transform: scale(1.05); }

    /* Overlay seguro para mostrar la imagen sin window.open ni document.write */
    .overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.9); display: none; align-items: center; justify-content: center; z-index: 9999; }
    .overlay.open { display: flex; }
    .overlay img { max-width: 90vw; max-height: 90vh; border-radius: 12px; box-shadow: 0 0 20px rgba(255,255,255,0.35); }
    .overlay .close { position: absolute; top: 16px; right: 16px; background: rgba(255,255,255,0.15); color: #fff; border: 1px solid rgba(255,255,255,0.25); padding: 8px 12px; border-radius: 10px; cursor: pointer; }

    /* Accesibilidad: respeta reduce motion */
    @media (prefers-reduced-motion: reduce) {
      .heart-anim, .bg-heart, .rose, h1, h2 { animation: none !important; }
    }
  </style>
</head>
<body>
  <!-- Capa de rosas y coraz√≥n de fondo -->
  <div class="scene" aria-hidden="true">
    <svg class="bg-heart" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
      <path d="M100 178 L32 110 C10 88 10 53 33 32 C54 13 88 16 106 38 C124 16 158 13 179 32 C202 53 202 88 180 110 L100 178 Z" fill="#e91e63"/>
    </svg>
  </div>

  <!-- Overlay para ver la foto -->
  <div id="overlay" class="overlay" aria-hidden="true" role="dialog" aria-label="Foto de nuestros recuerdos">
    <button class="close" id="overlayClose" aria-label="Cerrar">Cerrar ‚úï</button>
    <img id="overlayImg" src="" alt="Nuestros recuerdos" />
  </div>

  <div class="wrap">
    <div class="card">
      <h1 id="loveTitle">
        <svg class="heart-anim" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 6 4 4 6.5 4c1.74 0 3.41 1.01 4.22 2.57C11.09 5.01 12.76 4 14.5 4 17 4 19 6 19 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
        Te amo
        <svg class="heart-anim" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 6 4 4 6.5 4c1.74 0 3.41 1.01 4.22 2.57C11.09 5.01 12.76 4 14.5 4 17 4 19 6 19 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
      </h1>
      <div id="hiddenMessage" class="hidden-message">Te amo m√°s cada d√≠a ‚ù§Ô∏è</div>

      <p>Hoy celebramos 1 a√±o y 3 meses. Me haces feliz. Quiero seguir a tu lado cada d√≠a.</p>
      <img class="hero" src="" alt="Nuestra foto" />

      <h2>Lo que siento por ti</h2>
      <ul>
        <li>Te amo mucho y te respeto. Eres mi compa√±era de vida.</li>
        <li>Siempre te apoyar√© en todo. Cuentas conmigo.</li>
        <li>Quiero formar una familia contigo. Deseo construir nuestro hogar.</li>
      </ul>

      <h2>Promesas claras</h2>
      <ul>
        <li>Te escuchar√© con atenci√≥n. Responder√© con honestidad.</li>
        <li>Cuidar√© tu paz. Har√© mi parte en casa y en nuestros planes.</li>
        <li>Celebrar√© tus logros. Estar√© contigo en los retos.</li>
        <li>Trabajar√© por nuestro futuro. Tomaremos decisiones juntos.</li>
      </ul>

      <h2>Nuestro presente</h2>
      <p>Llevamos 1 a√±o y 3 meses unidos. Este tiempo vale oro para m√≠. Aprendimos a hablar mejor, a ser pacientes y a re√≠r m√°s. Quiero que sigamos creciendo los dos.</p>

      <h2>Nuestro plan</h2>
      <ul>
        <li>Cuidar nuestra relaci√≥n cada d√≠a. Un detalle, una palabra, un abrazo.</li>
        <li>Apoyar tus metas y tus estudios o proyectos. Tu crecimiento es mi prioridad.</li>
        <li>Guardar tiempo para nosotros. Una salida sencilla a la semana.</li>
        <li>Ahorrar para nuestra familia. Paso a paso, con disciplina.</li>
      </ul>

      <p class="heart">Con todo mi amor, hoy y siempre.</p>
      <p class="note">Si ves esto en el tel√©fono, puedes guardar la p√°gina y enviarla por mensaje.</p>
      <p class="footer">Hecho para ti</p>
      <div class="actions">
        <button class="memories-btn" onclick="openMemories()">üíû Ver nuestros recuerdos</button>
      </div>
    </div>
  </div>

  <!-- √Årea opcional para ver resultados de pruebas en modo #test -->
  <details id="testResults" style="display:none; max-width:720px; margin: 16px auto;">
    <summary>Resultados de pruebas</summary>
    <pre id="testLog"></pre>
  </details>

  <script>
    // Configuraci√≥n
    const IMAGE_URL = 'https://i.postimg.cc/N01rDHy5/Whats-App-Image-2024-08-06-at-11-12-57-AM-2.jpg';

    // Abrir y cerrar overlay de forma segura, sin nuevas ventanas
    function openMemories(opts = {}) {
      const overlay = document.getElementById('overlay');
      const img = document.getElementById('overlayImg');
      if (!overlay || !img) return;
      img.src = IMAGE_URL;
      overlay.classList.add('open');
      overlay.setAttribute('aria-hidden', 'false');
      if (opts.silent) {
        // para tests: abre y cierra sin molestar al usuario
        setTimeout(() => closeMemories(), 150);
      }
    }
    function closeMemories() {
      const overlay = document.getElementById('overlay');
      const img = document.getElementById('overlayImg');
      if (!overlay || !img) return;
      overlay.classList.remove('open');
      overlay.setAttribute('aria-hidden', 'true');
      img.removeAttribute('src');
    }

    document.addEventListener('DOMContentLoaded', () => {
      // Generar lluvia de rosas
      const scene = document.querySelector('.scene');
      const ROSE_COUNT = 40;
      function rand(min, max) { return Math.random() * (max - min) + min }
      for (let i = 0; i < ROSE_COUNT; i++) {
        const r = document.createElement('span');
        r.className = 'rose';
        r.textContent = 'üåπ';
        const left = rand(0, 100);
        const delay = rand(0, 2);
        const duration = rand(10, 20);
        r.style.left = left + 'vw';
        r.style.animationDuration = duration + 's, ' + rand(4, 8) + 's';
        r.style.animationDelay = delay + 's, ' + rand(0, 1) + 's';
        scene.appendChild(r);
      }

      // Mostrar mensaje oculto al hacer clic en el t√≠tulo
      const title = document.getElementById('loveTitle');
      const hiddenMessage = document.getElementById('hiddenMessage');
      title.addEventListener('click', () => {
        hiddenMessage.style.display = hiddenMessage.style.display === 'block' ? 'none' : 'block';
      });

      // Cerrar overlay con bot√≥n, tecla Esc o clic fuera de la imagen
      const overlay = document.getElementById('overlay');
      const overlayClose = document.getElementById('overlayClose');
      overlayClose.addEventListener('click', closeMemories);
      overlay.addEventListener('click', (e) => { if (e.target === overlay) closeMemories(); });
      window.addEventListener('keydown', (e) => { if (e.key === 'Escape') closeMemories(); });

      // Auto pruebas si la URL termina en #test
      if (location.hash === '#test') { runTests(); }
    });

    // Pruebas simples para verificar la p√°gina
    function runTests() {
      const logEl = document.getElementById('testLog');
      const panel = document.getElementById('testResults');
      const results = [];
      function assert(name, cond) {
        const ok = !!cond;
        results.push((ok ? 'PASS' : 'FAIL') + ' - ' + name);
        return ok;
      }
      // Espera breve para que se creen las rosas
      setTimeout(() => {
        assert('Existe capa .scene', !!document.querySelector('.scene'));
        assert('Se crearon rosas', document.querySelectorAll('.rose').length >= 20);
        assert('T√≠tulo con corazones presente', !!document.getElementById('loveTitle'));

        // Test de overlay abrir y cerrar en modo silencioso
        openMemories({ silent: true });
        const overlay = document.getElementById('overlay');
        assert('Overlay se abre', overlay.classList.contains('open'));
        setTimeout(() => {
          assert('Overlay se cierra', !overlay.classList.contains('open'));
          if (panel && logEl) {
            panel.style.display = 'block';
            logEl.textContent = results.join('\n');
          } else {
            console.log(results.join('\n'));
          }
        }, 200);
      }, 300);
    }
  </script>
</body>
</html>
